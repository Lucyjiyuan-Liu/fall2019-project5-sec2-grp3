---
title: "EDA Part 2"
author: "jl5217 Jiyuan Liu"
date: "12/5/2019"
output: pdf_document
---

```{r setup, include=FALSE}
load("~/Downloads/NFL_data_resample.RData")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=sum_dis,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Distance")+
  coord_flip()
```

## Including Plots

You can also embed plots, for example:

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=mean_speed,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Speed Mean")+
  coord_flip()
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=var_speed,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Speed Variance")+
  coord_flip()
```

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=mean_dir,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Direction Change Mean")+
  coord_flip()
```

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=var_dir,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Direction Change Variance")+
  coord_flip()
```

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=mean_acc,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Acceleration(Deceleration) Mean")+
  coord_flip()
```

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=var_acc,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Acceleration(Deceleration) Variance")+
  coord_flip()
```

```{r}
ggplot(NFL_data_resample,aes(x=RosterPosition,y=var_acc,fill=indicator)) +
  geom_boxplot() +
  labs(x="RosterPosition",y="Acceleration(Deceleration) Variance")+
  coord_flip()
```


```{r}
## Logistic regression
NFL_data_resample_subset <- NFL_data_resample[NFL_data_resample$Weather!="indoors" | NFL_data_resample$StadiumType %in% c("dome_closed","indoor_closed"),]
NFL_data_resample_subset <- NFL_data_resample_subset[NFL_data_resample_subset$Weather!="unknown",]
NFL_data_resample_subset$indicator <- ifelse(NFL_data_resample_subset$indicator=="non-injured",0,1)

## Consider environment 
NFL_data_resample_subset$Indoor <- ifelse(NFL_data_resample_subset$StadiumType %in% c("dome_closed","indoor_closed") | NFL_data_resample_subset$Weather=="indoors",1,0)

NFL_data_resample_subset$Outdoor_rain  <- ifelse(NFL_data_resample_subset$StadiumType == "Outdoor" & NFL_data_resample_subset$Weather=="rain",1,0)

NFL_data_resample_subset$Outdoor_overcast  <- ifelse(NFL_data_resample_subset$StadiumType == "Outdoor" & NFL_data_resample_subset$Weather=="overcast",1,0)

NFL_data_resample_subset$Outdoor_clear  <- ifelse(NFL_data_resample_subset$StadiumType == "Outdoor" & NFL_data_resample_subset$Weather=="clear",1,0)

NFL_data_resample_subset$Outdoor_snow  <- ifelse(NFL_data_resample_subset$StadiumType == "Outdoor" & NFL_data_resample_subset$Weather=="snow",1,0)

NFL_data_resample_subset$Indoor_rain  <- ifelse(NFL_data_resample_subset$StadiumType %in% c("dome_open","indoor_open") & NFL_data_resample_subset$Weather=="rain",1,0)

NFL_data_resample_subset$Indoor_overcast  <- ifelse(NFL_data_resample_subset$StadiumType %in% c("dome_open","indoor_open") & NFL_data_resample_subset$Weather=="overcast",1,0)

NFL_data_resample_subset$Indoor_clear  <- ifelse(NFL_data_resample_subset$StadiumType %in% c("dome_open","indoor_open") & NFL_data_resample_subset$Weather=="clear",1,0)

NFL_data_resample_subset$Indoor_snow  <- ifelse(NFL_data_resample_subset$StadiumType %in% c("dome_open","indoor_open") & NFL_data_resample_subset$Weather=="snow",1,0)

NFL_data_resample_subset$indicator <- ifelse(NFL_data_resample_subset$indicator=="non-injured",0,1)

fit <- glm(indicator ~ sum_dis + mean_speed + var_speed + mean_dir + var_dir + mean_acc + FieldType + Temperature + Indoor + Outdoor_rain + Outdoor_overcast + Outdoor_clear + Outdoor_snow, 
             data = NFL_data_resample_subset, family = "binomial")
summary(fit)


```


